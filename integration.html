<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="本项目的目标是提供php项目使用Jenkins创建任务的标准模版" />
  <meta name="author" content="Sebastian Bergmann" />
  <title>Jenkins任务模版-PHP版: 集成</title>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700|Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]>
  <script src="js/html5shiv.js"></script>
  <script src="js/respond.min.js"></script>
  <![endif]-->
 </head>
 <body>
  <div id="wrap">
   <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
     <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
       <span class="sr-only">Toggle Navigation</span>
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Jenkins任务模版-PHP版</a>
     </div>
     <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
          <li><a href="index.html">首页</a></li>
          <li><a href="installation.html">安装</a></li>
          <li><a href="automation.html">自动化</a></li>
          <li><a href="configuration.html">配置</a></li>
          <li class="active"><a href="integration.html">集成</a></li>
          <li><a href="example.html">实例</a></li>
          <li><a href="support.html">支持</a></li>
      </ul>
     </div>
    </div>
   </div>
   <div class="container">
    <div class="page-header">
     <h1>集成</h1>
    </div>
    <h2>使用任务模版</h2>
    <ol>
     <li><p>从你的jenkins服务器下载 jenkins-cli.jar:</p>
     <pre>wget http://localhost:8080/jnlpJars/jenkins-cli.jar</pre></li>
     <li><p>下载安装任务模版:</p>
     <pre>curl -L https://raw.githubusercontent.com/sebastianbergmann/php-jenkins-template/master/config.xml | \
     java -jar jenkins-cli.jar -s http://localhost:8080 create-job php-template</pre>
     <p><strong>或者</strong> 手工添加任务:</p>
     <pre>cd $JENKINS_HOME/jobs
mkdir php-template
cd php-template
wget https://raw.github.com/sebastianbergmann/php-jenkins-template/master/config.xml
cd ..
chown -R jenkins:jenkins php-template/</pre></li>
     <li><p>重新加载 Jenkins配置，下例中使用Jenkins的CLI:</p>
     <pre>java -jar jenkins-cli.jar -s http://localhost:8080 reload-configuration</pre></li>
     <li><p>点击 "New Job新建任务".</p></li>
     <li><p>输入一个 "Job name任务名称".</p></li>
     <li><p>选择 "Copy existing job复制已存在的任务" 并输入 "php-template" 到 "Copy from 复制于" 字段.</p></li>
     <li><p>点击 "OK".</p></li>
     <li><p>取消勾选 "Disable Build 不构建" 选项.</p></li>
     <li><p>填写 "Source Code Management源码管理" 相关信息.</p></li>
     <li><p>配置一个 "Build Trigger构建触发器", 例如 "Poll SCM".</p></li>
     <li><p>点击 "Save"保存.</p></li>
    </ol>
    <h2>错误排查</h2>
    <h3>没有 "Copy existing job" 选项 / "php-template" 项目为出现</h3>
    <p>Jenkins 没找到 <code>php-template</code> 任务. 确保你把文件复制到正确目录里了. 检查权限确保 Jenkins 用户可以读写这些目录. 重启 Jenkins.</p>
    <h3>常规设置问题处理方法</h3>
    <p>检查管理面板 <code>http://localhost:8080/manage</code> 和 <a href="http://wiki.jenkins-ci.org/display/JENKINS/Logging">Jenkins 日志</a> 获取信息.</p>
    <h3>在项目状态页面显示的HTML代码</h3>
    <p><a href="https://issues.jenkins-ci.org/browse/JENKINS-22028"> Jenkins 1.553</a>默认渲染的 HTML 有改动. 为了正确显示 PHP_Depend生成的图表, 需要启用安全选项 <code>http://localhost/configureSecurity/</code> 并修改 <code>Markup Formatter 标记格式</code> 为 <code>Raw HTML原始HTML</code>.</p>
   </div>
  </div>
  <div id="footer">
   <div class="container">
    <p class="text-muted">The "<span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type"><a xmlns:cc="http://creativecommons.org/ns#" href="http://jenkins-php.org/" property="cc:attributionName" rel="cc:attributionURL">Jenkins任务模版-PHP版</a></span>" by <a href="http://sebastian-bergmann.de/">Sebastian Bergmann</a> and his contributors is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</p>
   </div>
  </div>
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(["trackPageView"]);
  _paq.push(["enableLinkTracking"]);

  (function() {
    var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.sebastian-bergmann.de/";
    _paq.push(["setTrackerUrl", u+"piwik.php"]);
    _paq.push(["setSiteId", "6"]);
    var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
    g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
  })();
  </script>
 </body>
</html>
